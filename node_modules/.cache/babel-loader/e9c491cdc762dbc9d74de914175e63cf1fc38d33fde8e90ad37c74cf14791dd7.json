{"ast":null,"code":"import _objectSpread from\"C:/Users/DELL/OneDrive/Desktop/collabeaseproject/collabeasesorce/collabease/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useContext,useRef,useCallback}from'react';import axios from'axios';import{DragDropContext,Droppable,Draggable}from'@hello-pangea/dnd';import{ProjectContext}from'../context/ProjectContext';import{AuthContext}from'../context/AuthContext';import CreateTaskModal from'./CreateTaskModal';import TaskDetailModal from'./TaskDetailModal';import{io}from'socket.io-client';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TaskBoard=_ref=>{let{project,onTaskUpdate}=_ref;const{createTask,updateTask,deleteTask}=useContext(ProjectContext);const{user}=useContext(AuthContext);const[tasks,setTasks]=useState(project.tasks||[]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[selectedTask,setSelectedTask]=useState(null);const[isCreateModalOpen,setIsCreateModalOpen]=useState(false);const[activeFilter,setActiveFilter]=useState('all');const[searchTerm,setSearchTerm]=useState('');const buttonClickTimeoutRef=useRef(null);const socketRef=useRef(null);const ignoreNextUpdateRef=useRef(false);// Get socket io instance\nuseEffect(()=>{// Import socket.io client dynamically to prevent SSR issues\nimport('socket.io-client').then(_ref2=>{let{io}=_ref2;const socket=io(process.env.REACT_APP_API_URL||'http://localhost:5000');socketRef.current=socket;// Authenticate with user ID if available\nconst token=localStorage.getItem('token');if(token){try{const payload=JSON.parse(atob(token.split('.')[1]));if(payload&&payload.id){socket.emit('authenticate',{userId:payload.id});// Join project room to receive project-specific updates\nif(project&&project._id){socket.emit('join:project',project._id);console.log(\"Joined project room: \".concat(project._id));}}}catch(err){console.error('Error authenticating socket:',err);}}return()=>{// Leave project room when component unmounts\nif(socket&&project&&project._id){socket.emit('leave:project',project._id);}socket.disconnect();};});},[project._id]);useEffect(()=>{if(project&&project.tasks){setTasks(project.tasks||[]);setLoading(false);}},[project]);const handleDragEnd=async result=>{const{destination,source,draggableId}=result;// If dropped outside a droppable area\nif(!destination)return;// If dropped in the same position\nif(destination.droppableId===source.droppableId&&destination.index===source.index)return;// Find the task that was dragged\nconst task=tasks.find(task=>task._id===draggableId);if(!task)return;// Update task status based on the destination column\nconst newStatus=destination.droppableId;// Store original tasks for rollback\nconst originalTasks=[...tasks];// Update task locally first for immediate UI feedback\nconst updatedTasks=tasks.map(t=>t._id===task._id?_objectSpread(_objectSpread({},t),{},{status:newStatus}):t);setTasks(updatedTasks);// Skip the next socket update since we're the initiator\nignoreNextUpdateRef.current=true;// Then update on the server\ntry{const token=localStorage.getItem('token');if(!token){setError('Authentication required. Please log in again.');setTasks(originalTasks);// Revert to original state\nignoreNextUpdateRef.current=false;return;}const result=await axios.put(\"/api/tasks/\".concat(task._id),{status:newStatus},{headers:{'Authorization':\"Bearer \".concat(token)}});if(result.data){// Server update successful\nif(onTaskUpdate){onTaskUpdate();}}else{setError('Failed to update task status');setTasks(originalTasks);// Revert if failed\nignoreNextUpdateRef.current=false;}}catch(err){var _err$response,_err$response$data;// Revert to original state if server update fails\nsetTasks(originalTasks);ignoreNextUpdateRef.current=false;console.error('Error updating task status:',err);setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Failed to update task status. Please try again.');}};const handleStatusChange=async(taskId,newStatus)=>{try{// Store original tasks for rollback\nconst originalTasks=[...tasks];// Get the task to update\nconst taskToUpdate=tasks.find(task=>task._id===taskId);if(!taskToUpdate){console.error(\"Task with id \".concat(taskId,\" not found\"));setError(\"Could not find task to update\");return;}// Update task locally first for immediate UI feedback\nconst updatedTasks=tasks.map(task=>task._id===taskId?_objectSpread(_objectSpread({},task),{},{status:newStatus}):task);setTasks(updatedTasks);// Skip the next socket update since we're the initiator\nignoreNextUpdateRef.current=true;const token=localStorage.getItem('token');if(!token){setError('Authentication required. Please log in again.');setTasks(originalTasks);// Revert to original state\nignoreNextUpdateRef.current=false;return;}// Then update on the server directly to avoid another layer of abstraction\nconst result=await axios.put(\"/api/tasks/\".concat(taskId),{status:newStatus},{headers:{'Authorization':\"Bearer \".concat(token)}});if(result.data){// Server update successful\nif(onTaskUpdate){onTaskUpdate();}// For completed tasks, add celebration effect or notification\nif(newStatus==='completed'){setToastMessage({message:\"Task \\\"\".concat(taskToUpdate.title,\"\\\" completed successfully!\"),type:'success',duration:3000});}}else{setError('Failed to update task status');setTasks(originalTasks);// Revert if failed\nignoreNextUpdateRef.current=false;}}catch(err){console.error('Error updating task status:',err);// Set clear error message\nif(err.response&&err.response.data&&err.response.data.message){setError(\"Failed to update task: \".concat(err.response.data.message));}else if(err.message){setError(\"Failed to update task: \".concat(err.message));}else{setError('Failed to update task. Please try again.');}// Revert to original state if server update fails\n// Get original tasks again to ensure we have the latest state\nconst originalTasks=[...tasks];setTasks(originalTasks);ignoreNextUpdateRef.current=false;}};const handleDeleteTask=async taskId=>{if(!window.confirm('Are you sure you want to delete this task?')){return;}try{// Remove task locally first for immediate UI feedback\nconst updatedTasks=tasks.filter(task=>task._id!==taskId);setTasks(updatedTasks);// Then delete from the server\nconst result=await deleteTask(project._id,taskId);// Close modal if the deleted task was selected\nif(selectedTask&&selectedTask._id===taskId){setSelectedTask(null);}if(!result.success){setError(result.message||'Failed to delete task');setTasks(tasks);// Revert if failed\n}else if(onTaskUpdate){onTaskUpdate();}}catch(err){setError('Failed to delete task');console.error('Error deleting task:',err);}};const handleCreateTask=async taskData=>{try{const result=await createTask(project._id,taskData);if(result.success){// Add the new task to our local state\nsetTasks([...tasks,result.task]);setIsCreateModalOpen(false);if(onTaskUpdate){onTaskUpdate();}}else{setError(result.message||'Failed to create task');}}catch(err){setError('Failed to create task');console.error('Error creating task:',err);}};const handleUpdateTask=async(taskId,updatedData)=>{try{// Store original tasks for potential rollback\nconst originalTasks=[...tasks];// Find the task we're updating\nconst taskToUpdate=tasks.find(task=>task._id===taskId);if(!taskToUpdate){setError('Task not found');return;}// Skip the next socket update since we're the initiator\nignoreNextUpdateRef.current=true;// Update task locally first for immediate UI feedback\nconst updatedTasks=tasks.map(task=>task._id===taskId?_objectSpread(_objectSpread({},task),updatedData):task);setTasks(updatedTasks);// Call the updateTask method from ProjectContext\nconst result=await updateTask(project._id,taskId,updatedData);if(result.success){// Update the task in our local state\nsetTasks(tasks.map(task=>task._id===taskId?result.task:task));setSelectedTask(null);if(onTaskUpdate){onTaskUpdate();}}else{setError(result.message||'Failed to update task');// Restore original state\nsetTasks(originalTasks);}}catch(err){console.error('Error updating task:',err);// Set clear error message\nif(err.response&&err.response.data&&err.response.data.message){setError(\"Failed to update task: \".concat(err.response.data.message));}else if(err.message){setError(\"Failed to update task: \".concat(err.message));}else{setError('Failed to update task. Please try again.');}// Get the original tasks for rollback\nconst originalTasks=[...tasks];setTasks(originalTasks);ignoreNextUpdateRef.current=false;}};const handleAddTaskClick=useCallback(()=>{// Prevent rapid clicks by using a ref instead of state\nif(buttonClickTimeoutRef.current)return;// Open the modal\nsetIsCreateModalOpen(true);// Set a flag to prevent multiple clicks\nbuttonClickTimeoutRef.current=true;// Clear the flag after a delay\nsetTimeout(()=>{buttonClickTimeoutRef.current=null;},500);},[]);// Clean up timeout on unmount\nuseEffect(()=>{return()=>{buttonClickTimeoutRef.current=null;};},[]);const filteredTasks=tasks.filter(task=>{if(!task)return false;// Apply active filter\nif(activeFilter!=='all'){if(activeFilter==='completed'&&task.status!=='completed')return false;if(activeFilter==='in_progress'&&task.status!=='in_progress')return false;if(activeFilter==='to_do'&&task.status!=='to_do')return false;}// Apply search filter\nif(searchTerm){const term=searchTerm.toLowerCase();return task.title&&task.title.toLowerCase().includes(term)||task.description&&task.description.toLowerCase().includes(term);}return true;});const todoTasks=filteredTasks.filter(task=>task.status==='to_do'||task.status==='backlog');const inProgressTasks=filteredTasks.filter(task=>task.status==='in_progress');const completedTasks=filteredTasks.filter(task=>task.status==='completed');// Listen for real-time task updates via Socket.io\nuseEffect(()=>{if(!socketRef.current)return;// Listen for task updates from other users\nsocketRef.current.on('task:update',data=>{// Skip this update if we're the originator or if there's no data\nif(ignoreNextUpdateRef.current||!data){ignoreNextUpdateRef.current=false;return;}// Handle different update formats\nif(data.task){var _data$updatedBy;// If we get a full task object\nsetTasks(prevTasks=>{return prevTasks.map(t=>t._id===data.task._id?_objectSpread(_objectSpread({},t),data.task):t);});// If this task is currently selected, update it\nsetSelectedTask(prevTask=>prevTask&&prevTask._id===data.task._id?_objectSpread(_objectSpread({},prevTask),data.task):prevTask);// Show notification for task update\nsetToastMessage({message:\"Task \\\"\".concat(data.task.title,\"\\\" was updated by \").concat(((_data$updatedBy=data.updatedBy)===null||_data$updatedBy===void 0?void 0:_data$updatedBy.displayName)||'another user'),type:'info',duration:4000});}else if(data.taskId&&data.update){// If we get an update object\nsetTasks(prevTasks=>{return prevTasks.map(t=>t._id===data.taskId?_objectSpread(_objectSpread({},t),data.update):t);});// If this task is currently selected, update it\nsetSelectedTask(prevTask=>prevTask&&prevTask._id===data.taskId?_objectSpread(_objectSpread({},prevTask),data.update):prevTask);// Display notification for automation-triggered updates\nif(data.automationTriggered&&data.message){// Show a toast notification\nsetToastMessage({message:data.message,type:'info',duration:5000});}}});// Listen for new tasks\nsocketRef.current.on('task:create',data=>{var _data$createdBy;if(!data||!data.task)return;// Add the new task to our local state\nsetTasks(prevTasks=>[...prevTasks,data.task]);// Show notification\nsetToastMessage({message:\"New task \\\"\".concat(data.task.title,\"\\\" was added by \").concat(((_data$createdBy=data.createdBy)===null||_data$createdBy===void 0?void 0:_data$createdBy.displayName)||'another user'),type:'info',duration:4000});});// Listen for deleted tasks\nsocketRef.current.on('task:delete',data=>{var _data$deletedBy;if(!data||!data.taskId)return;// Remove the task from our local state\nsetTasks(prevTasks=>prevTasks.filter(t=>t._id!==data.taskId));// If this task is currently selected, close the modal\nif(selectedTask&&selectedTask._id===data.taskId){setSelectedTask(null);}// Show notification\nsetToastMessage({message:\"A task was deleted by \".concat(((_data$deletedBy=data.deletedBy)===null||_data$deletedBy===void 0?void 0:_data$deletedBy.displayName)||'another user'),type:'info',duration:4000});});// Listen for automation events\nsocketRef.current.on('project:automation',data=>{if(data&&data.message){// Show a toast notification for the automation\nsetToastMessage({message:data.message,type:'automation',duration:5000});}});return()=>{if(socketRef.current){socketRef.current.off('task:update');socketRef.current.off('task:create');socketRef.current.off('task:delete');socketRef.current.off('project:automation');}};},[socketRef.current]);// State for toast notifications\nconst[toastMessage,setToastMessage]=useState(null);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"linear-spinner\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"linear-fade-in\",children:[error&&/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card bg-red-50 border-red-200 mb-4 p-3 text-red-700 flex justify-between\",children:[/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setError(''),className:\"text-red-500 hover:text-red-700\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center justify-between gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleAddTaskClick,className:\"linear-btn linear-btn-primary flex items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-4 w-4 mr-1\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z\",clipRule:\"evenodd\"})}),\"Add Task\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex rounded-md shadow-sm\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveFilter('all'),className:\"linear-btn \".concat(activeFilter==='all'?'linear-btn-primary':'linear-btn-secondary',\" rounded-r-none\"),children:\"All\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveFilter('to_do'),className:\"linear-btn \".concat(activeFilter==='to_do'?'linear-btn-primary':'linear-btn-secondary',\" rounded-none border-l-0 border-r-0\"),children:\"To Do\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveFilter('in_progress'),className:\"linear-btn \".concat(activeFilter==='in_progress'?'linear-btn-primary':'linear-btn-secondary',\" rounded-none border-r-0\"),children:\"In Progress\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveFilter('completed'),className:\"linear-btn \".concat(activeFilter==='completed'?'linear-btn-primary':'linear-btn-secondary',\" rounded-l-none\"),children:\"Completed\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-full md:w-64\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-4 w-4 text-gray-500 dark:text-gray-400\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"})})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search tasks...\",className:\"linear-input pl-9 pr-10 w-full focus:ring-2 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)}),searchTerm&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-y-0 right-0 pr-3 flex items-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSearchTerm(''),className:\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-4 w-4\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})})})]})]}),/*#__PURE__*/_jsx(DragDropContext,{onDragEnd:handleDragEnd,children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card-header flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 rounded-full bg-gray-400 mr-2\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium\",children:\"To Do\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"linear-badge linear-badge-secondary\",children:todoTasks.length})]}),/*#__PURE__*/_jsx(Droppable,{droppableId:\"to_do\",children:provided=>/*#__PURE__*/_jsxs(\"div\",_objectSpread(_objectSpread({ref:provided.innerRef},provided.droppableProps),{},{className:\"linear-card-body p-2 h-[calc(100vh-280px)] overflow-y-auto\",children:[todoTasks.length>0?todoTasks.map((task,index)=>/*#__PURE__*/_jsx(Draggable,{draggableId:task._id,index:index,children:provided=>{var _task$assignedTo$disp;return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread(_objectSpread({ref:provided.innerRef},provided.draggableProps),provided.dragHandleProps),{},{className:\"linear-card mb-2 cursor-pointer hover:shadow-md transition-shadow\",onClick:()=>setSelectedTask(task),children:/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card-body p-3\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium mb-1\",children:task.title}),task.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 line-clamp-2 mb-3\",children:task.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"linear-badge \".concat(task.priority==='high'?'linear-badge-danger':task.priority==='medium'?'linear-badge-warning':'linear-badge-success'),children:task.priority}),task.assignedTo&&/*#__PURE__*/_jsx(\"div\",{className:\"linear-avatar linear-avatar-xs\",title:task.assignedTo.displayName||'User',children:task.assignedTo.photo?/*#__PURE__*/_jsx(\"img\",{src:task.assignedTo.photo,alt:task.assignedTo.displayName||'User'}):/*#__PURE__*/_jsx(\"span\",{children:((_task$assignedTo$disp=task.assignedTo.displayName)===null||_task$assignedTo$disp===void 0?void 0:_task$assignedTo$disp.charAt(0))||'?'})})]})]})}));}},task._id)):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-6 text-gray-500 text-sm\",children:\"No tasks\"}),provided.placeholder]}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card-header flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 rounded-full bg-blue-500 mr-2\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium\",children:\"In Progress\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"linear-badge linear-badge-secondary\",children:inProgressTasks.length})]}),/*#__PURE__*/_jsx(Droppable,{droppableId:\"in_progress\",children:provided=>/*#__PURE__*/_jsxs(\"div\",_objectSpread(_objectSpread({ref:provided.innerRef},provided.droppableProps),{},{className:\"linear-card-body p-2 h-[calc(100vh-280px)] overflow-y-auto\",children:[inProgressTasks.length>0?inProgressTasks.map((task,index)=>/*#__PURE__*/_jsx(Draggable,{draggableId:task._id,index:index,children:provided=>{var _task$assignedTo$disp2;return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread(_objectSpread({ref:provided.innerRef},provided.draggableProps),provided.dragHandleProps),{},{className:\"linear-card mb-2 cursor-pointer hover:shadow-md transition-shadow\",onClick:()=>setSelectedTask(task),children:/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card-body p-3\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium mb-1\",children:task.title}),task.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 line-clamp-2 mb-3\",children:task.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"linear-badge \".concat(task.priority==='high'?'linear-badge-danger':task.priority==='medium'?'linear-badge-warning':'linear-badge-success'),children:task.priority}),task.assignedTo&&/*#__PURE__*/_jsx(\"div\",{className:\"linear-avatar linear-avatar-xs\",title:task.assignedTo.displayName||'User',children:task.assignedTo.photo?/*#__PURE__*/_jsx(\"img\",{src:task.assignedTo.photo,alt:task.assignedTo.displayName||'User'}):/*#__PURE__*/_jsx(\"span\",{children:((_task$assignedTo$disp2=task.assignedTo.displayName)===null||_task$assignedTo$disp2===void 0?void 0:_task$assignedTo$disp2.charAt(0))||'?'})})]})]})}));}},task._id)):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-6 text-gray-500 text-sm\",children:\"No tasks\"}),provided.placeholder]}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card-header flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 rounded-full bg-green-500 mr-2\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium\",children:\"Completed\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"linear-badge linear-badge-secondary\",children:completedTasks.length})]}),/*#__PURE__*/_jsx(Droppable,{droppableId:\"completed\",children:provided=>/*#__PURE__*/_jsxs(\"div\",_objectSpread(_objectSpread({ref:provided.innerRef},provided.droppableProps),{},{className:\"linear-card-body p-2 h-[calc(100vh-280px)] overflow-y-auto\",children:[completedTasks.length>0?completedTasks.map((task,index)=>/*#__PURE__*/_jsx(Draggable,{draggableId:task._id,index:index,children:provided=>{var _task$assignedTo$disp3;return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread(_objectSpread({ref:provided.innerRef},provided.draggableProps),provided.dragHandleProps),{},{className:\"linear-card mb-2 cursor-pointer hover:shadow-md transition-shadow\",onClick:()=>setSelectedTask(task),children:/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card-body p-3\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium mb-1 line-through text-gray-500\",children:task.title}),task.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400 line-clamp-2 mb-3\",children:task.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"linear-badge linear-badge-success\",children:\"Completed\"}),task.assignedTo&&/*#__PURE__*/_jsx(\"div\",{className:\"linear-avatar linear-avatar-xs\",title:task.assignedTo.displayName||'User',children:task.assignedTo.photo?/*#__PURE__*/_jsx(\"img\",{src:task.assignedTo.photo,alt:task.assignedTo.displayName||'User'}):/*#__PURE__*/_jsx(\"span\",{children:((_task$assignedTo$disp3=task.assignedTo.displayName)===null||_task$assignedTo$disp3===void 0?void 0:_task$assignedTo$disp3.charAt(0))||'?'})})]})]})}));}},task._id)):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-6 text-gray-500 text-sm\",children:\"No completed tasks\"}),provided.placeholder]}))})]})]})}),isCreateModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"linear-modal-overlay\",children:/*#__PURE__*/_jsx(\"div\",{className:\"linear-modal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"linear-card-header flex justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium\",children:\"Create Task\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsCreateModalOpen(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\",clipRule:\"evenodd\"})})})]}),/*#__PURE__*/_jsx(CreateTaskModal,{projectId:project._id,onClose:()=>setIsCreateModalOpen(false),onSave:handleCreateTask,projectMembers:project.members||[]})]})})}),selectedTask&&/*#__PURE__*/_jsx(\"div\",{className:\"linear-modal-overlay\",children:/*#__PURE__*/_jsx(\"div\",{className:\"linear-modal\",children:/*#__PURE__*/_jsx(TaskDetailModal,{task:selectedTask,onClose:()=>setSelectedTask(null),onUpdate:updatedData=>handleUpdateTask(selectedTask._id,updatedData),onDelete:()=>handleDeleteTask(selectedTask._id),projectMembers:project.members||[]})})}),toastMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed bottom-4 right-4 p-4 rounded-md shadow-lg z-50 max-w-md transition-opacity duration-300 \".concat(toastMessage.type==='automation'?'bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300':toastMessage.type==='success'?'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300':'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start\",children:[toastMessage.type==='automation'&&/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-6 w-6 mr-2 flex-shrink-0\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M13 10V3L4 14h7v7l9-11h-7z\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:toastMessage.message})}),/*#__PURE__*/_jsx(\"button\",{className:\"ml-4 text-sm font-medium focus:outline-none flex-shrink-0\",onClick:()=>setToastMessage(null),children:\"\\u2715\"})]})})]});};export default TaskBoard;","map":{"version":3,"names":["React","useState","useEffect","useContext","useRef","useCallback","axios","DragDropContext","Droppable","Draggable","ProjectContext","AuthContext","CreateTaskModal","TaskDetailModal","io","jsx","_jsx","jsxs","_jsxs","TaskBoard","_ref","project","onTaskUpdate","createTask","updateTask","deleteTask","user","tasks","setTasks","loading","setLoading","error","setError","selectedTask","setSelectedTask","isCreateModalOpen","setIsCreateModalOpen","activeFilter","setActiveFilter","searchTerm","setSearchTerm","buttonClickTimeoutRef","socketRef","ignoreNextUpdateRef","then","_ref2","socket","process","env","REACT_APP_API_URL","current","token","localStorage","getItem","payload","JSON","parse","atob","split","id","emit","userId","_id","console","log","concat","err","disconnect","handleDragEnd","result","destination","source","draggableId","droppableId","index","task","find","newStatus","originalTasks","updatedTasks","map","t","_objectSpread","status","put","headers","data","_err$response","_err$response$data","response","message","handleStatusChange","taskId","taskToUpdate","setToastMessage","title","type","duration","handleDeleteTask","window","confirm","filter","success","handleCreateTask","taskData","handleUpdateTask","updatedData","handleAddTaskClick","setTimeout","filteredTasks","term","toLowerCase","includes","description","todoTasks","inProgressTasks","completedTasks","on","_data$updatedBy","prevTasks","prevTask","updatedBy","displayName","update","automationTriggered","_data$createdBy","createdBy","_data$deletedBy","deletedBy","off","toastMessage","className","children","onClick","xmlns","viewBox","fill","fillRule","d","clipRule","stroke","strokeLinecap","strokeLinejoin","strokeWidth","placeholder","value","onChange","e","target","onDragEnd","length","provided","ref","innerRef","droppableProps","_task$assignedTo$disp","draggableProps","dragHandleProps","priority","assignedTo","photo","src","alt","charAt","_task$assignedTo$disp2","_task$assignedTo$disp3","projectId","onClose","onSave","projectMembers","members","onUpdate","onDelete"],"sources":["C:/Users/DELL/OneDrive/Desktop/collabeaseproject/collabeasesorce/collabease/client/src/components/TaskBoard.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext, useRef, useCallback } from 'react';\nimport axios from 'axios';\nimport { DragDropContext, Droppable, Draggable } from '@hello-pangea/dnd';\nimport { ProjectContext } from '../context/ProjectContext';\nimport { AuthContext } from '../context/AuthContext';\nimport CreateTaskModal from './CreateTaskModal';\nimport TaskDetailModal from './TaskDetailModal';\nimport { io } from 'socket.io-client';\n\nconst TaskBoard = ({ project, onTaskUpdate }) => {\n  const { createTask, updateTask, deleteTask } = useContext(ProjectContext);\n  const { user } = useContext(AuthContext);\n  const [tasks, setTasks] = useState(project.tasks || []);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [selectedTask, setSelectedTask] = useState(null);\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n  const [activeFilter, setActiveFilter] = useState('all');\n  const [searchTerm, setSearchTerm] = useState('');\n  const buttonClickTimeoutRef = useRef(null);\n  const socketRef = useRef(null);\n  const ignoreNextUpdateRef = useRef(false);\n  \n  // Get socket io instance\n  useEffect(() => {\n    // Import socket.io client dynamically to prevent SSR issues\n    import('socket.io-client').then(({ io }) => {\n      const socket = io(process.env.REACT_APP_API_URL || 'http://localhost:5000');\n      socketRef.current = socket;\n      \n      // Authenticate with user ID if available\n      const token = localStorage.getItem('token');\n      if (token) {\n        try {\n          const payload = JSON.parse(atob(token.split('.')[1]));\n          if (payload && payload.id) {\n            socket.emit('authenticate', { userId: payload.id });\n            \n            // Join project room to receive project-specific updates\n            if (project && project._id) {\n              socket.emit('join:project', project._id);\n              console.log(`Joined project room: ${project._id}`);\n            }\n          }\n        } catch (err) {\n          console.error('Error authenticating socket:', err);\n        }\n      }\n      \n      return () => {\n        // Leave project room when component unmounts\n        if (socket && project && project._id) {\n          socket.emit('leave:project', project._id);\n        }\n        socket.disconnect();\n      };\n    });\n  }, [project._id]);\n  \n  useEffect(() => {\n    if (project && project.tasks) {\n      setTasks(project.tasks || []);\n        setLoading(false);\n      }\n  }, [project]);\n  \n  const handleDragEnd = async (result) => {\n    const { destination, source, draggableId } = result;\n    \n    // If dropped outside a droppable area\n    if (!destination) return;\n    \n    // If dropped in the same position\n    if (\n      destination.droppableId === source.droppableId &&\n      destination.index === source.index\n    ) return;\n    \n    // Find the task that was dragged\n    const task = tasks.find(task => task._id === draggableId);\n    \n    if (!task) return;\n    \n    // Update task status based on the destination column\n    const newStatus = destination.droppableId;\n    \n    // Store original tasks for rollback\n    const originalTasks = [...tasks];\n    \n    // Update task locally first for immediate UI feedback\n    const updatedTasks = tasks.map(t => \n      t._id === task._id ? { ...t, status: newStatus } : t\n    );\n    setTasks(updatedTasks);\n    \n    // Skip the next socket update since we're the initiator\n    ignoreNextUpdateRef.current = true;\n    \n    // Then update on the server\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        setError('Authentication required. Please log in again.');\n        setTasks(originalTasks); // Revert to original state\n        ignoreNextUpdateRef.current = false;\n        return;\n      }\n      \n      const result = await axios.put(`/api/tasks/${task._id}`, \n        { status: newStatus },\n        { headers: { 'Authorization': `Bearer ${token}` }}\n      );\n      \n      if (result.data) {\n        // Server update successful\n        if (onTaskUpdate) {\n          onTaskUpdate();\n        }\n      } else {\n        setError('Failed to update task status');\n        setTasks(originalTasks); // Revert if failed\n        ignoreNextUpdateRef.current = false;\n      }\n    } catch (err) {\n      // Revert to original state if server update fails\n      setTasks(originalTasks);\n      ignoreNextUpdateRef.current = false;\n      console.error('Error updating task status:', err);\n      setError(err.response?.data?.message || 'Failed to update task status. Please try again.');\n    }\n  };\n  \n  const handleStatusChange = async (taskId, newStatus) => {\n    try {\n      // Store original tasks for rollback\n      const originalTasks = [...tasks];\n      \n      // Get the task to update\n      const taskToUpdate = tasks.find(task => task._id === taskId);\n      if (!taskToUpdate) {\n        console.error(`Task with id ${taskId} not found`);\n        setError(`Could not find task to update`);\n        return;\n      }\n      \n      // Update task locally first for immediate UI feedback\n      const updatedTasks = tasks.map(task => \n        task._id === taskId ? { ...task, status: newStatus } : task\n      );\n      setTasks(updatedTasks);\n      \n      // Skip the next socket update since we're the initiator\n      ignoreNextUpdateRef.current = true;\n      \n      const token = localStorage.getItem('token');\n      if (!token) {\n        setError('Authentication required. Please log in again.');\n        setTasks(originalTasks); // Revert to original state\n        ignoreNextUpdateRef.current = false;\n        return;\n      }\n      \n      // Then update on the server directly to avoid another layer of abstraction\n      const result = await axios.put(`/api/tasks/${taskId}`, \n        { status: newStatus },\n        { headers: { 'Authorization': `Bearer ${token}` }}\n      );\n      \n      if (result.data) {\n        // Server update successful\n        if (onTaskUpdate) {\n          onTaskUpdate();\n        }\n        \n        // For completed tasks, add celebration effect or notification\n        if (newStatus === 'completed') {\n          setToastMessage({\n            message: `Task \"${taskToUpdate.title}\" completed successfully!`,\n            type: 'success',\n            duration: 3000\n          });\n        }\n      } else {\n        setError('Failed to update task status');\n        setTasks(originalTasks); // Revert if failed\n        ignoreNextUpdateRef.current = false;\n      }\n    } catch (err) {\n      console.error('Error updating task status:', err);\n      \n      // Set clear error message\n      if (err.response && err.response.data && err.response.data.message) {\n        setError(`Failed to update task: ${err.response.data.message}`);\n      } else if (err.message) {\n        setError(`Failed to update task: ${err.message}`);\n      } else {\n        setError('Failed to update task. Please try again.');\n      }\n      \n      // Revert to original state if server update fails\n      // Get original tasks again to ensure we have the latest state\n      const originalTasks = [...tasks];\n      setTasks(originalTasks);\n      ignoreNextUpdateRef.current = false;\n    }\n  };\n  \n  const handleDeleteTask = async (taskId) => {\n    if (!window.confirm('Are you sure you want to delete this task?')) {\n      return;\n    }\n    \n    try {\n      // Remove task locally first for immediate UI feedback\n      const updatedTasks = tasks.filter(task => task._id !== taskId);\n      setTasks(updatedTasks);\n      \n      // Then delete from the server\n      const result = await deleteTask(project._id, taskId);\n      \n      // Close modal if the deleted task was selected\n      if (selectedTask && selectedTask._id === taskId) {\n        setSelectedTask(null);\n      }\n      \n      if (!result.success) {\n        setError(result.message || 'Failed to delete task');\n        setTasks(tasks); // Revert if failed\n      } else if (onTaskUpdate) {\n        onTaskUpdate();\n      }\n    } catch (err) {\n      setError('Failed to delete task');\n      console.error('Error deleting task:', err);\n    }\n  };\n  \n  const handleCreateTask = async (taskData) => {\n    try {\n      const result = await createTask(project._id, taskData);\n      if (result.success) {\n        // Add the new task to our local state\n        setTasks([...tasks, result.task]);\n        setIsCreateModalOpen(false);\n        \n        if (onTaskUpdate) {\n          onTaskUpdate();\n        }\n      } else {\n        setError(result.message || 'Failed to create task');\n      }\n    } catch (err) {\n      setError('Failed to create task');\n      console.error('Error creating task:', err);\n    }\n  };\n  \n  const handleUpdateTask = async (taskId, updatedData) => {\n    try {\n      // Store original tasks for potential rollback\n      const originalTasks = [...tasks];\n      \n      // Find the task we're updating\n      const taskToUpdate = tasks.find(task => task._id === taskId);\n      if (!taskToUpdate) {\n        setError('Task not found');\n        return;\n      }\n      \n      // Skip the next socket update since we're the initiator\n      ignoreNextUpdateRef.current = true;\n      \n      // Update task locally first for immediate UI feedback\n      const updatedTasks = tasks.map(task => \n        task._id === taskId ? { ...task, ...updatedData } : task\n      );\n      setTasks(updatedTasks);\n      \n      // Call the updateTask method from ProjectContext\n      const result = await updateTask(project._id, taskId, updatedData);\n      \n      if (result.success) {\n        // Update the task in our local state\n        setTasks(tasks.map(task => task._id === taskId ? result.task : task));\n        setSelectedTask(null);\n        \n        if (onTaskUpdate) {\n          onTaskUpdate();\n        }\n      } else {\n        setError(result.message || 'Failed to update task');\n        // Restore original state\n        setTasks(originalTasks);\n      }\n    } catch (err) {\n      console.error('Error updating task:', err);\n      \n      // Set clear error message\n      if (err.response && err.response.data && err.response.data.message) {\n        setError(`Failed to update task: ${err.response.data.message}`);\n      } else if (err.message) {\n        setError(`Failed to update task: ${err.message}`);\n      } else {\n        setError('Failed to update task. Please try again.');\n      }\n      \n      // Get the original tasks for rollback\n      const originalTasks = [...tasks];\n      setTasks(originalTasks);\n      ignoreNextUpdateRef.current = false;\n    }\n  };\n  \n  const handleAddTaskClick = useCallback(() => {\n    // Prevent rapid clicks by using a ref instead of state\n    if (buttonClickTimeoutRef.current) return;\n    \n    // Open the modal\n    setIsCreateModalOpen(true);\n    \n    // Set a flag to prevent multiple clicks\n    buttonClickTimeoutRef.current = true;\n    \n    // Clear the flag after a delay\n    setTimeout(() => {\n      buttonClickTimeoutRef.current = null;\n    }, 500);\n  }, []);\n  \n  // Clean up timeout on unmount\n  useEffect(() => {\n    return () => {\n      buttonClickTimeoutRef.current = null;\n    };\n  }, []);\n  \n  const filteredTasks = tasks.filter(task => {\n    if (!task) return false;\n    \n    // Apply active filter\n    if (activeFilter !== 'all') {\n      if (activeFilter === 'completed' && task.status !== 'completed') return false;\n      if (activeFilter === 'in_progress' && task.status !== 'in_progress') return false;\n      if (activeFilter === 'to_do' && task.status !== 'to_do') return false;\n    }\n    \n    // Apply search filter\n    if (searchTerm) {\n      const term = searchTerm.toLowerCase();\n      return (\n        (task.title && task.title.toLowerCase().includes(term)) || \n        (task.description && task.description.toLowerCase().includes(term))\n      );\n    }\n    \n    return true;\n  });\n  \n  const todoTasks = filteredTasks.filter(task => task.status === 'to_do' || task.status === 'backlog');\n  const inProgressTasks = filteredTasks.filter(task => task.status === 'in_progress');\n  const completedTasks = filteredTasks.filter(task => task.status === 'completed');\n  \n  // Listen for real-time task updates via Socket.io\n  useEffect(() => {\n    if (!socketRef.current) return;\n    \n    // Listen for task updates from other users\n    socketRef.current.on('task:update', (data) => {\n      // Skip this update if we're the originator or if there's no data\n      if (ignoreNextUpdateRef.current || !data) {\n        ignoreNextUpdateRef.current = false;\n        return;\n      }\n      \n      // Handle different update formats\n      if (data.task) {\n        // If we get a full task object\n        setTasks(prevTasks => {\n          return prevTasks.map(t => \n            t._id === data.task._id ? { ...t, ...data.task } : t\n          );\n        });\n        \n        // If this task is currently selected, update it\n        setSelectedTask(prevTask => \n          prevTask && prevTask._id === data.task._id \n            ? { ...prevTask, ...data.task }\n            : prevTask\n        );\n        \n        // Show notification for task update\n        setToastMessage({\n          message: `Task \"${data.task.title}\" was updated by ${data.updatedBy?.displayName || 'another user'}`,\n          type: 'info',\n          duration: 4000\n        });\n      } else if (data.taskId && data.update) {\n        // If we get an update object\n        setTasks(prevTasks => {\n          return prevTasks.map(t => \n            t._id === data.taskId ? { ...t, ...data.update } : t\n          );\n        });\n        \n        // If this task is currently selected, update it\n        setSelectedTask(prevTask => \n          prevTask && prevTask._id === data.taskId \n            ? { ...prevTask, ...data.update }\n            : prevTask\n        );\n        \n        // Display notification for automation-triggered updates\n        if (data.automationTriggered && data.message) {\n          // Show a toast notification\n          setToastMessage({\n            message: data.message,\n            type: 'info',\n            duration: 5000\n          });\n        }\n      }\n    });\n    \n    // Listen for new tasks\n    socketRef.current.on('task:create', (data) => {\n      if (!data || !data.task) return;\n      \n      // Add the new task to our local state\n      setTasks(prevTasks => [...prevTasks, data.task]);\n      \n      // Show notification\n      setToastMessage({\n        message: `New task \"${data.task.title}\" was added by ${data.createdBy?.displayName || 'another user'}`,\n        type: 'info',\n        duration: 4000\n      });\n    });\n    \n    // Listen for deleted tasks\n    socketRef.current.on('task:delete', (data) => {\n      if (!data || !data.taskId) return;\n      \n      // Remove the task from our local state\n      setTasks(prevTasks => prevTasks.filter(t => t._id !== data.taskId));\n      \n      // If this task is currently selected, close the modal\n      if (selectedTask && selectedTask._id === data.taskId) {\n        setSelectedTask(null);\n      }\n      \n      // Show notification\n      setToastMessage({\n        message: `A task was deleted by ${data.deletedBy?.displayName || 'another user'}`,\n        type: 'info',\n        duration: 4000\n      });\n    });\n    \n    // Listen for automation events\n    socketRef.current.on('project:automation', (data) => {\n      if (data && data.message) {\n        // Show a toast notification for the automation\n        setToastMessage({\n          message: data.message,\n          type: 'automation',\n          duration: 5000\n        });\n      }\n    });\n    \n    return () => {\n      if (socketRef.current) {\n        socketRef.current.off('task:update');\n        socketRef.current.off('task:create');\n        socketRef.current.off('task:delete');\n        socketRef.current.off('project:automation');\n      }\n    };\n  }, [socketRef.current]);\n  \n  // State for toast notifications\n  const [toastMessage, setToastMessage] = useState(null);\n  \n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"linear-spinner\"></div>\n      </div>\n    );\n  }\n  \n    return (\n    <div className=\"linear-fade-in\">\n        {error && (\n        <div className=\"linear-card bg-red-50 border-red-200 mb-4 p-3 text-red-700 flex justify-between\">\n          <p>{error}</p>\n          <button \n            onClick={() => setError('')}\n            className=\"text-red-500 hover:text-red-700\"\n          >\n            &times;\n          </button>\n          </div>\n        )}\n        \n      <div className=\"flex flex-wrap items-center justify-between gap-4 mb-6\">\n        <div className=\"flex items-center gap-2\">\n          <button \n            onClick={handleAddTaskClick}\n            className=\"linear-btn linear-btn-primary flex items-center\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 mr-1\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path fillRule=\"evenodd\" d=\"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z\" clipRule=\"evenodd\" />\n            </svg>\n            Add Task\n          </button>\n          \n          <div className=\"inline-flex rounded-md shadow-sm\">\n            <button \n              onClick={() => setActiveFilter('all')}\n              className={`linear-btn ${activeFilter === 'all' ? 'linear-btn-primary' : 'linear-btn-secondary'} rounded-r-none`}\n            >\n              All\n            </button>\n            <button \n              onClick={() => setActiveFilter('to_do')}\n              className={`linear-btn ${activeFilter === 'to_do' ? 'linear-btn-primary' : 'linear-btn-secondary'} rounded-none border-l-0 border-r-0`}\n            >\n              To Do\n            </button>\n            <button \n              onClick={() => setActiveFilter('in_progress')}\n              className={`linear-btn ${activeFilter === 'in_progress' ? 'linear-btn-primary' : 'linear-btn-secondary'} rounded-none border-r-0`}\n            >\n              In Progress\n            </button>\n            <button \n              onClick={() => setActiveFilter('completed')}\n              className={`linear-btn ${activeFilter === 'completed' ? 'linear-btn-primary' : 'linear-btn-secondary'} rounded-l-none`}\n            >\n              Completed\n            </button>\n          </div>\n        </div>\n        \n        <div className=\"relative w-full md:w-64\">\n          <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n            </svg>\n          </div>\n          <input \n            type=\"text\"\n            placeholder=\"Search tasks...\"\n            className=\"linear-input pl-9 pr-10 w-full focus:ring-2 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n          {searchTerm && (\n            <div className=\"absolute inset-y-0 right-0 pr-3 flex items-center\">\n              <button \n                onClick={() => setSearchTerm('')}\n                className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none\"\n              >\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n      \n      <DragDropContext onDragEnd={handleDragEnd}>\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          {/* To Do Column */}\n          <div className=\"linear-card\">\n            <div className=\"linear-card-header flex items-center justify-between\">\n              <div className=\"flex items-center\">\n                <div className=\"w-3 h-3 rounded-full bg-gray-400 mr-2\"></div>\n                <h3 className=\"font-medium\">To Do</h3>\n              </div>\n              <span className=\"linear-badge linear-badge-secondary\">{todoTasks.length}</span>\n            </div>\n            <Droppable droppableId=\"to_do\">\n              {(provided) => (\n                <div\n                  ref={provided.innerRef}\n                  {...provided.droppableProps}\n                  className=\"linear-card-body p-2 h-[calc(100vh-280px)] overflow-y-auto\"\n                >\n                  {todoTasks.length > 0 ? (\n                    todoTasks.map((task, index) => (\n                    <Draggable key={task._id} draggableId={task._id} index={index}>\n                      {(provided) => (\n                        <div\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                          {...provided.dragHandleProps}\n                            className=\"linear-card mb-2 cursor-pointer hover:shadow-md transition-shadow\"\n                          onClick={() => setSelectedTask(task)}\n                        >\n                            <div className=\"linear-card-body p-3\">\n                              <h4 className=\"text-sm font-medium mb-1\">{task.title}</h4>\n                          {task.description && (\n                                <p className=\"text-xs text-gray-500 line-clamp-2 mb-3\">{task.description}</p>\n                              )}\n                              <div className=\"flex items-center justify-between\">\n                                <span className={`linear-badge ${\n                                  task.priority === 'high' ? 'linear-badge-danger' :\n                                  task.priority === 'medium' ? 'linear-badge-warning' :\n                                  'linear-badge-success'\n                                }`}>\n                                  {task.priority}\n                                </span>\n                                \n                                {task.assignedTo && (\n                                  <div className=\"linear-avatar linear-avatar-xs\" title={task.assignedTo.displayName || 'User'}>\n                                    {task.assignedTo.photo ? (\n                                      <img src={task.assignedTo.photo} alt={task.assignedTo.displayName || 'User'} />\n                                    ) : (\n                                      <span>{task.assignedTo.displayName?.charAt(0) || '?'}</span>\n                                    )}\n                                    </div>\n                                  )}\n                                </div>\n                          </div>\n                        </div>\n                      )}\n                    </Draggable>\n                    ))\n                  ) : (\n                    <div className=\"text-center py-6 text-gray-500 text-sm\">\n                      No tasks\n                    </div>\n                  )}\n                  {provided.placeholder}\n                </div>\n              )}\n            </Droppable>\n          </div>\n          \n          {/* In Progress Column */}\n          <div className=\"linear-card\">\n            <div className=\"linear-card-header flex items-center justify-between\">\n              <div className=\"flex items-center\">\n                <div className=\"w-3 h-3 rounded-full bg-blue-500 mr-2\"></div>\n                <h3 className=\"font-medium\">In Progress</h3>\n              </div>\n              <span className=\"linear-badge linear-badge-secondary\">{inProgressTasks.length}</span>\n            </div>\n            <Droppable droppableId=\"in_progress\">\n              {(provided) => (\n                <div\n                  ref={provided.innerRef}\n                  {...provided.droppableProps}\n                  className=\"linear-card-body p-2 h-[calc(100vh-280px)] overflow-y-auto\"\n                >\n                  {inProgressTasks.length > 0 ? (\n                    inProgressTasks.map((task, index) => (\n                    <Draggable key={task._id} draggableId={task._id} index={index}>\n                      {(provided) => (\n                        <div\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                          {...provided.dragHandleProps}\n                            className=\"linear-card mb-2 cursor-pointer hover:shadow-md transition-shadow\"\n                          onClick={() => setSelectedTask(task)}\n                        >\n                            <div className=\"linear-card-body p-3\">\n                              <h4 className=\"text-sm font-medium mb-1\">{task.title}</h4>\n                          {task.description && (\n                                <p className=\"text-xs text-gray-500 line-clamp-2 mb-3\">{task.description}</p>\n                              )}\n                              <div className=\"flex items-center justify-between\">\n                                <span className={`linear-badge ${\n                                  task.priority === 'high' ? 'linear-badge-danger' :\n                                  task.priority === 'medium' ? 'linear-badge-warning' :\n                                  'linear-badge-success'\n                                }`}>\n                                  {task.priority}\n                                </span>\n                                \n                                {task.assignedTo && (\n                                  <div className=\"linear-avatar linear-avatar-xs\" title={task.assignedTo.displayName || 'User'}>\n                                    {task.assignedTo.photo ? (\n                                      <img src={task.assignedTo.photo} alt={task.assignedTo.displayName || 'User'} />\n                                    ) : (\n                                      <span>{task.assignedTo.displayName?.charAt(0) || '?'}</span>\n                                    )}\n                                    </div>\n                                  )}\n                                </div>\n                          </div>\n                        </div>\n                      )}\n                    </Draggable>\n                    ))\n                  ) : (\n                    <div className=\"text-center py-6 text-gray-500 text-sm\">\n                      No tasks\n                    </div>\n                  )}\n                  {provided.placeholder}\n                </div>\n              )}\n            </Droppable>\n          </div>\n          \n          {/* Completed Column */}\n          <div className=\"linear-card\">\n            <div className=\"linear-card-header flex items-center justify-between\">\n              <div className=\"flex items-center\">\n                <div className=\"w-3 h-3 rounded-full bg-green-500 mr-2\"></div>\n                <h3 className=\"font-medium\">Completed</h3>\n              </div>\n              <span className=\"linear-badge linear-badge-secondary\">{completedTasks.length}</span>\n            </div>\n            <Droppable droppableId=\"completed\">\n              {(provided) => (\n                <div\n                  ref={provided.innerRef}\n                  {...provided.droppableProps}\n                  className=\"linear-card-body p-2 h-[calc(100vh-280px)] overflow-y-auto\"\n                >\n                  {completedTasks.length > 0 ? (\n                    completedTasks.map((task, index) => (\n                    <Draggable key={task._id} draggableId={task._id} index={index}>\n                      {(provided) => (\n                        <div\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                          {...provided.dragHandleProps}\n                            className=\"linear-card mb-2 cursor-pointer hover:shadow-md transition-shadow\"\n                          onClick={() => setSelectedTask(task)}\n                        >\n                            <div className=\"linear-card-body p-3\">\n                              <h4 className=\"text-sm font-medium mb-1 line-through text-gray-500\">{task.title}</h4>\n                          {task.description && (\n                                <p className=\"text-xs text-gray-400 line-clamp-2 mb-3\">{task.description}</p>\n                              )}\n                              <div className=\"flex items-center justify-between\">\n                                <span className=\"linear-badge linear-badge-success\">\n                                  Completed\n                                </span>\n                                \n                                {task.assignedTo && (\n                                  <div className=\"linear-avatar linear-avatar-xs\" title={task.assignedTo.displayName || 'User'}>\n                                    {task.assignedTo.photo ? (\n                                      <img src={task.assignedTo.photo} alt={task.assignedTo.displayName || 'User'} />\n                                    ) : (\n                                      <span>{task.assignedTo.displayName?.charAt(0) || '?'}</span>\n                                    )}\n                                    </div>\n                                  )}\n                                </div>\n                          </div>\n                        </div>\n                      )}\n                    </Draggable>\n                    ))\n                  ) : (\n                    <div className=\"text-center py-6 text-gray-500 text-sm\">\n                      No completed tasks\n                    </div>\n                  )}\n                  {provided.placeholder}\n                </div>\n              )}\n            </Droppable>\n          </div>\n        </div>\n      </DragDropContext>\n      \n      {/* Create Task Modal */}\n      {isCreateModalOpen && (\n        <div className=\"linear-modal-overlay\">\n          <div className=\"linear-modal\">\n            <div className=\"linear-card\">\n              <div className=\"linear-card-header flex justify-between\">\n                <h3 className=\"font-medium\">Create Task</h3>\n                <button \n                  onClick={() => setIsCreateModalOpen(false)}\n                  className=\"text-gray-500 hover:text-gray-700\"\n                >\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                    <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                  </svg>\n                </button>\n              </div>\n              \n        <CreateTaskModal \n          projectId={project._id}\n          onClose={() => setIsCreateModalOpen(false)}\n                onSave={handleCreateTask}\n                projectMembers={project.members || []}\n              />\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Task Detail Modal */}\n      {selectedTask && (\n        <div className=\"linear-modal-overlay\">\n          <div className=\"linear-modal\">\n            <TaskDetailModal \n              task={selectedTask}\n              onClose={() => setSelectedTask(null)}\n              onUpdate={(updatedData) => handleUpdateTask(selectedTask._id, updatedData)}\n              onDelete={() => handleDeleteTask(selectedTask._id)}\n              projectMembers={project.members || []}\n            />\n          </div>\n        </div>\n      )}\n      \n      {/* Toast Message */}\n      {toastMessage && (\n        <div \n          className={`fixed bottom-4 right-4 p-4 rounded-md shadow-lg z-50 max-w-md transition-opacity duration-300 ${\n            toastMessage.type === 'automation' \n              ? 'bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300' \n              : toastMessage.type === 'success'\n              ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300'\n              : 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300'\n          }`}\n        >\n          <div className=\"flex items-start\">\n            {toastMessage.type === 'automation' && (\n              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6 mr-2 flex-shrink-0\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\n              </svg>\n            )}\n            <div>\n              <p className=\"font-medium\">{toastMessage.message}</p>\n            </div>\n            <button \n              className=\"ml-4 text-sm font-medium focus:outline-none flex-shrink-0\"\n              onClick={() => setToastMessage(null)}\n            >\n              ✕\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TaskBoard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}